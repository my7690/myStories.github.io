<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ÙˆÙ‚Ø¹ Ø±ÙˆØ§ÙŠØ§ØªÙŠ</title>

    <!-- Firebase CDN (Compat) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>

    <style>
        /* Ø«ÙŠÙ… Ø£Ø²Ø±Ù‚ Ø¨Ø§Ø³ØªÙŠÙ„ Ù‡Ø§Ø¯ÙŠ */
        :root {
            --primary-color: #60a5fa;
            --secondary-color: #e0f2fe;
            --text-color: #1e293b;
            --card-bg: #ffffff;
            --shadow: 0 8px 25px rgba(37, 99, 235, 0.12);
            --gradient: linear-gradient(135deg, #bfdbfe 0%, #60a5fa 50%, #1d4ed8 100%);
        }

        /* Story Type Themes */
        .theme-romance {
            --primary-color: #e91e63;
            --secondary-color: #fce4ec;
            --text-color: #880e4f;
            --gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .theme-drama {
            --primary-color: #ff9800;
            --secondary-color: #fff3e0;
            --text-color: #e65100;
            --gradient: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
        }

        .theme-mystery {
            --primary-color: #673ab7;
            --secondary-color: #f3e5f5;
            --text-color: #4a148c;
            --gradient: linear-gradient(135deg, #868f96 0%, #596164 100%);
        }

        .theme-suspense {
            --primary-color: #795548;
            --secondary-color: #efebe9;
            --text-color: #3e2723;
            --gradient: linear-gradient(135deg, #29323c 0%, #485563 100%);
        }

        /* Navigation Bar */
        .navbar {
            background: var(--gradient);
            padding: 1rem 2rem;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-logo {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
            list-style: none;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 25px;
            transition: all 0.3s ease;
        }

        .nav-links a:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .user-section {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: white;
        }

        .login-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid white;
            padding: 0.5rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .login-btn:hover {
            background: white;
            color: var(--primary-color);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Header Styles */
        .main-header {
            background: var(--gradient);
            color: white;
            padding: 3rem 2rem;
            text-align: center;
            border-radius: 20px;
            margin-bottom: 3rem;
            box-shadow: var(--shadow);
        }

        .main-header h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .theme-indicator {
            font-size: 1.1rem;
            opacity: 0.9;
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 25px;
            border-radius: 25px;
            display: inline-block;
        }

        /* Story of the Day */
        .story-of-day {
            background: var(--gradient);
            color: white;
            padding: 2.5rem;
            border-radius: 20px;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
            position: relative;
        }

        .story-of-day:hover {
            transform: translateY(-5px);
        }

        .story-of-day h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
        }

        .daily-badge {
            background: rgba(255,255,255,0.2);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .reset-daily-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255, 255, 255, 0.3);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .reset-daily-btn:hover {
            background: rgba(255, 255, 255, 0.5);
            transform: scale(1.1);
        }

        /* Ideas Section */
        .ideas-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .ideas-section h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
        }

        .idea-form {
            background: var(--secondary-color);
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .idea-input, .discussion-input {
            width: 100%;
            padding: 1.2rem;
            border: 2px solid var(--primary-color);
            border-radius: 12px;
            margin-bottom: 1rem;
            resize: vertical;
            min-height: 100px;
            background: var(--card-bg);
            color: var(--text-color);
            font-size: 1rem;
        }

        .submit-idea-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .submit-idea-btn:hover {
            transform: scale(1.05);
        }

        /* Stories Grid */
        .stories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 25px;
            margin-bottom: 3rem;
        }

        .story-card {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: var(--shadow);
            cursor: pointer;
            transition: all 0.4s ease;
            border: 3px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .story-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient);
        }

        .story-card:hover {
            transform: translateY(-10px);
            border-color: var(--primary-color);
        }

        .story-card h3 {
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .story-card .category {
            background: var(--gradient);
            color: white;
            padding: 8px 18px;
            border-radius: 25px;
            font-size: 0.85rem;
            display: inline-block;
            margin-bottom: 1rem;
        }

        /* Cafe Section */
        .cafe-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 2.5rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .cafe-section h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.8rem;
        }

        .discussion-form {
            background: var(--secondary-color);
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .discussions-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .discussion-item {
            background: var(--secondary-color);
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 1rem;
            border-right: 4px solid var(--primary-color);
        }

        .discussion-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem;
            font-size: 0.9rem;
            color: var(--text-color);
            opacity: 0.7;
        }

        .user-badge {
            background: var(--primary-color);
            color: white;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
        }

        /* Like and Reply System */
        .discussion-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .like-btn, .reply-btn {
            background: none;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .like-btn {
            color: var(--text-color);
        }

        .like-btn.liked {
            color: #e74c3c;
        }

        .like-btn:hover, .reply-btn:hover {
            background: rgba(0,0,0,0.1);
        }

        .reply-btn {
            color: var(--primary-color);
        }

        .replies-section {
            margin-top: 1rem;
            padding-right: 1rem;
            border-right: 2px solid var(--secondary-color);
        }

        .reply-item {
            background: var(--card-bg);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            border: 1px solid var(--secondary-color);
        }

        .reply-form {
            display: none;
            margin-top: 1rem;
        }

        .reply-input {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid var(--primary-color);
            border-radius: 8px;
            margin-bottom: 0.5rem;
            resize: vertical;
            min-height: 60px;
            background: var(--card-bg);
            color: var(--text-color);
        }

        /* Login Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .login-modal {
            background: var(--card-bg);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: var(--shadow);
            width: 90%;
            max-width: 400px;
        }

        .login-modal h2 {
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-color);
        }

        .form-group input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--primary-color);
            border-radius: 8px;
            background: var(--secondary-color);
            color: var(--text-color);
            font-size: 1rem;
        }

        .remember-me {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            color: var(--text-color);
        }

        .remember-me input {
            width: auto;
        }

        .submit-login-btn {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1rem;
            width: 100%;
            transition: all 0.3s ease;
        }

        .submit-login-btn:hover {
            transform: scale(1.05);
        }

        /* Hidden Class */
        .hidden {
            display: none;
        }

        /* Back Button */
        .back-button {
            background: var(--gradient);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            cursor: pointer;
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .back-button:hover {
            transform: translateX(-5px);
        }

        /* Story Reading */
        .story-reading {
            background-color: var(--card-bg);
            border-radius: 20px;
            padding: 3rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            line-height: 1.8;
            border: 2px solid var(--primary-color);
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="nav-logo" onclick="showHomePage()">ğŸ“š Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ØµØµ</a>
            <ul class="nav-links">
                <li><a href="#" onclick="showHomePage()">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a></li>
                <li><a href="#" onclick="showStoriesPage()">Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ØµØµ</a></li>
                <li><a href="#" onclick="showCafePage()">Ù…Ù‚Ù‡Ù‰ Ø§Ù„Ø­ÙˆØ§Ø±</a></li>
            </ul>
            <div class="user-section" id="userSection">
                <button class="login-btn" onclick="showLoginModal()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
            </div>
        </div>
    </nav>

    <!-- Login Modal -->
    <div id="loginModal" class="modal-overlay hidden">
        <div class="login-modal">
            <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…:</label>
                    <input type="text" id="loginName" required>
                </div>
                <div class="form-group">
                    <label>ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±:</label>
                    <input type="password" id="loginPassword" required>
                </div>
                <div class="remember-me">
                    <input type="checkbox" id="rememberMe">
                    <label for="rememberMe">ØªØ°ÙƒØ±Ù†ÙŠ</label>
                </div>
                <button type="submit" class="submit-login-btn">Ø¯Ø®ÙˆÙ„</button>
            </form>
        </div>
    </div>

    <!-- Home Page -->
    <div id="homePage" class="container">
        <header class="main-header">
            <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ØµØµ</h1>
            <div class="theme-indicator" id="themeIndicator"></div>
        </header>

        <!-- Story of the Day -->
        <div class="story-of-day" id="storyOfDay" onclick="openDailyStory()">
            <button class="reset-daily-btn" onclick="resetDailyStory(event)">ğŸ”„ ØªØ¬Ø±Ø¨Ø©</button>
            <div class="daily-badge">Ù‚ØµØ© Ø§Ù„ÙŠÙˆÙ…</div>
            <h2 id="dailyStoryTitle">...</h2>
            <p id="dailyStoryDesc">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù‚ØµØ© Ø§Ù„ÙŠÙˆÙ…...</p>
        </div>

        <!-- Ideas Section -->
        <section class="ideas-section">
            <h2>ğŸ’¡ ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª</h2>
            <div class="idea-form">
                <textarea class="idea-input" id="ideaInput" placeholder="Ù…Ø§ Ø§Ù„ÙÙƒØ±Ø© Ø§Ù„ØªÙŠ ØªÙˆØ¯ Ø£Ù† ØªØ±Ø§Ù‡Ø§ ÙÙŠ Ø§Ù„Ù‚ØµØ© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©ØŸ Ø§ÙƒØªØ¨ Ø§Ù‚ØªØ±Ø§Ø­Ùƒ Ù‡Ù†Ø§..."></textarea>
                <button class="submit-idea-btn" onclick="submitIdea()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙÙƒØ±Ø© âœ¨</button>
            </div>
            <div class="discussions-list" id="ideasList">
                <!-- Ideas will be displayed here -->
            </div>
        </section>
    </div>

    <!-- Stories Library Page -->
    <div id="storiesPage" class="container hidden">
        <button class="back-button" onclick="showHomePage()">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <h1 style="text-align: center; color: var(--primary-color); margin-bottom: 3rem;">Ù…ÙƒØªØ¨Ø© Ø§Ù„Ù‚ØµØµ</h1>
        <div class="stories-grid" id="storiesGrid">
            <!-- All stories will be displayed here -->
        </div>
    </div>

    <!-- Cafe Page -->
    <div id="cafePage" class="container hidden">
        <button class="back-button" onclick="showHomePage()">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <section class="cafe-section">
            <h2>â˜• Ù…Ù‚Ù‡Ù‰ Ø§Ù„Ø­ÙˆØ§Ø±</h2>
            <div class="discussion-form">
                <textarea class="discussion-input" id="discussionInput" placeholder="Ù…Ø§Ø°Ø§ ØªÙˆØ¯ Ø£Ù† ØªÙ†Ø§Ù‚Ø´ Ù…Ø¹ Ø²ÙˆØ§Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ØŸ"></textarea>
                <button class="submit-idea-btn" onclick="submitDiscussion()">Ù†Ø´Ø± Ø§Ù„Ù†Ù‚Ø§Ø´ ğŸ’¬</button>
            </div>
            <div class="discussions-list" id="discussionsList">
                <!-- Discussions will be displayed here -->
            </div>
        </section>
    </div>

    <!-- Story Reading Section -->
    <section id="storyReadingSection" class="container hidden">
        <button class="back-button" onclick="showStoriesPage()">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙƒØªØ¨Ø©</button>
        <div class="story-reading" id="storyContent">
            <!-- Story content will be loaded here -->
        </div>
        <button class="submit-idea-btn" onclick="showQuestions()" style="margin-top: 2rem;">Ø£ÙƒÙ…Ù„Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ğŸ’­</button>
    </section>

    <!-- Questions Section -->
    <section id="questionsSection" class="container hidden">
        <button class="back-button" onclick="showStoryReading(currentStoryId)">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù‚ØµØ©</button>
        <div class="ideas-section">
            <h2>ğŸ’­ ÙÙƒØ± ÙÙŠÙ‡Ø§...</h2>
            <div id="questionsContainer">
                <!-- Questions will be loaded here -->
            </div>
            <div class="discussions-list" id="answersContainer">
                <!-- Answers will be displayed here -->
            </div>
        </div>
    </section>

    <script>
        // ========== Firebase Init ==========
        const firebaseConfig = {
            apiKey: "AIzaSyCTHtK0c0t9fSNmtukx8wSoZALrfnxmVhw",
            authDomain: "my-stories-site.firebaseapp.com",
            projectId: "my-stories-site",
            storageBucket: "my-stories-site.firebasestorage.app",
            messagingSenderId: "1027697190942",
            appId: "1:1027697190942:web:5798dc94e1358050caa60f",
            measurementId: "G-VE62Y5PRYJ"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const serverTimestamp = firebase.firestore.FieldValue.serverTimestamp;

        // ========== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ù…Ø¹ Ø§Ù„Ø«ÙŠÙ…Ø§Øª ==========
        const stories = [
            {
                id: 1,
                title: "Ø±Ø³Ø§Ø¦Ù„Ù†Ø§",
                category: "Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠØ©",
                theme: "theme-romance",
                description: "Ù‚ØµØ© Ø­Ø¨ ØªØ±ÙˆÙ‰ Ø¹Ø¨Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø³Ø±ÙŠØ©",
                content: `ÙÙŠ Ø¹Ø§Ù„Ù… Ø­ÙŠØ« Ø§Ù„ÙƒÙ„Ù…Ø§Øª ØªØµÙ†Ø¹ Ù…ØµØ§Ø¦Ø±ØŒ ØªØ¨Ø¯Ø£ Ù‚ØµØ© Ø­Ø¨ Ø¹Ø¨Ø± Ø±Ø³Ø§Ø¦Ù„ Ø³Ø±ÙŠØ©...`,
                questions: [
                    "Ù…Ø§ Ø±Ø£ÙŠÙƒ ÙÙŠ Ø§Ù„Ø­Ø¨ Ø¹Ø¨Ø± Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ØŸ",
                    "Ù‡Ù„ ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ø§Ù„Ø£Ø³Ø±Ø§Ø± ØªØ¬Ø¹Ù„ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø£ÙƒØ«Ø± Ø¥Ø«Ø§Ø±Ø©ØŸ"
                ]
            },
            {
                id: 2,
                title: "Ø²Ù…ÙŠÙ„ÙŠ",
                category: "Ø¯Ø±Ø§Ù…Ø§",
                theme: "theme-drama",
                description: "Ø¹Ù„Ø§Ù‚Ø© Ù…Ø¹Ù‚Ø¯Ø© Ø¨ÙŠÙ† Ø²Ù…Ù„Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„",
                content: `Ø®Ù„Ù Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ù…ÙƒØ§ØªØ¨ Ø§Ù„Ù…ØºÙ„Ù‚Ø©ØŒ ØªÙˆØ¬Ø¯ Ù‚ØµØµ Ù„Ø§ ÙŠØ¹Ø±ÙÙ‡Ø§ Ø£Ø­Ø¯...`,
                questions: [
                    "Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ø£Ù† ØªØªØ­ÙˆÙ„ Ø¹Ù„Ø§Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„ Ø¥Ù„Ù‰ Ø­Ø¨ØŸ",
                    "Ù…Ø§ Ø­Ø¯ÙˆØ¯ Ø§Ù„Ø¹Ù„Ø§Ù‚Ø© Ø¨ÙŠÙ† Ø§Ù„Ø²Ù…Ù„Ø§Ø¡ ÙÙŠ Ø§Ù„Ø¹Ù…Ù„ØŸ"
                ]
            },
            {
                id: 3,
                title: "Ø²ÙˆØ¬ØªÙ‡",
                category: "ØºÙ…ÙˆØ¶",
                theme: "theme-mystery",
                description: "Ø£Ø³Ø±Ø§Ø± Ø®Ù„Ù Ø£Ø¨ÙˆØ§Ø¨ Ù…ØºÙ„Ù‚Ø©",
                content: `Ù„ÙŠØ³Øª ÙƒÙ„ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨ Ø§Ù„Ù…ØºÙ„Ù‚Ø© ØªØ­Ù…ÙŠ Ø£Ø³Ø±Ø§Ø±Ø§Ù‹ØŒ Ø¨Ø¹Ø¶Ù‡Ø§ ÙŠØ®Ø¨Ø¦ Ø¬Ø±Ø§Ø¦Ù…...`,
                questions: [
                    "Ù…Ø§ Ø§Ù„Ø°ÙŠ ÙŠØ®ØªØ¨Ø¦ ÙˆØ±Ø§Ø¡ Ø§Ù„ÙˆØ¬ÙˆÙ‡ Ø§Ù„Ù‡Ø§Ø¯Ø¦Ø©ØŸ",
                    "Ù‡Ù„ ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ø§Ù„Ø²ÙˆØ§Ø¬ Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø³Ø¬Ù†Ø§Ù‹ØŸ"
                ]
            },
            {
                id: 4,
                title: "Ø´ÙŠØ¡ Ù„ÙŠ",
                category: "Ø¯Ø±Ø§Ù…Ø§",
                theme: "theme-drama",
                description: "Ø±Ø­Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø°Ø§Øª",
                content: `Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ ØªØ¶ÙŠØ¹ ÙÙŠ Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø´ÙŠØ¡ Ù„Ø§ ØªØ¹Ø±Ù Ø£Ù†Ù‡ ÙƒØ§Ù† Ù…Ø¹Ùƒ Ø·ÙˆØ§Ù„ Ø§Ù„ÙˆÙ‚Øª...`,
                questions: [
                    "Ù‡Ù„ ØªØ¹ØªÙ‚Ø¯ Ø£Ù† Ø§Ù„Ø¨Ø·Ù„Ø© ØªØºÙŠØ±Øª Ù„Ù„Ø£ÙØ¶Ù„ØŸ",
                    "Ù…Ù† ØªØªØ¹Ø§Ø·Ù Ù…Ø¹Ù‡ Ø£ÙƒØ«Ø±: Ø§Ù„Ø¨Ø·Ù„Ø© Ø£Ù… Ø§Ù„ØµØ¯ÙŠÙ‚Ø©ØŸ"
                ]
            }
        ];

        // ========== Ø­Ø§Ù„Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ==========
        let currentUser = null;
        let currentStoryId = null;

        function getUserName() {
            if (!currentUser) return "Ø²Ø§Ø¦Ø±";
            if (currentUser.displayName) return currentUser.displayName;
            if (currentUser.email) return currentUser.email.split("@")[0];
            return "Ù…Ø³ØªØ®Ø¯Ù…";
        }

        // ========== Ø§Ù„Ø«ÙŠÙ…Ø§Øª ==========
        function setTheme(themeClass, storyTitle = '') {
            document.body.className = themeClass || '';
            const themeNames = {
                'theme-romance': 'Ø±ÙˆÙ…Ø§Ù†Ø³ÙŠ ğŸ’–',
                'theme-drama': 'Ø¯Ø±Ø§Ù…ÙŠ ğŸ­',
                'theme-mystery': 'ØºØ§Ù…Ø¶ ğŸ•µï¸',
                'theme-suspense': 'ØªØ´ÙˆÙŠÙ‚ÙŠ ğŸ”'
            };

            const indicator = document.getElementById('themeIndicator');
            if (storyTitle && themeClass && themeNames[themeClass]) {
                indicator.textContent = `Ø«ÙŠÙ… ${themeNames[themeClass]} - ${storyTitle}`;
            } else {
                indicator.textContent = '';
            }
        }

        // ========== Ù‚ØµØ© Ø§Ù„ÙŠÙˆÙ… (Ù…Ø­Ù„ÙŠØ© Ù„ÙƒÙ„ Ø¬Ù‡Ø§Ø²) ==========
        function getDailyStory() {
            const today = new Date().toDateString();
            const saved = localStorage.getItem('daily_story');

            if (saved) {
                try {
                    const { date, storyId } = JSON.parse(saved);
                    if (date === today) {
                        const story = stories.find(s => s.id === storyId);
                        if (story) return story;
                    }
                } catch (e) {
                    console.error(e);
                }
            }

            const availableStories = stories.filter(s => s.id);
            if (!availableStories.length) return null;

            const randomStory = availableStories[Math.floor(Math.random() * availableStories.length)];
            localStorage.setItem('daily_story', JSON.stringify({
                date: today,
                storyId: randomStory.id,
                timestamp: Date.now()
            }));
            return randomStory;
        }

        function displayDailyStory() {
            const story = getDailyStory();
            const titleEl = document.getElementById('dailyStoryTitle');
            const descEl = document.getElementById('dailyStoryDesc');

            if (story) {
                titleEl.textContent = story.title;
                descEl.textContent = story.description;
            } else {
                titleEl.textContent = "Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ØµØ© Ø§Ù„ÙŠÙˆÙ…";
                descEl.textContent = "Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚ØµØµ...";
            }
        }

        function openDailyStory() {
            const story = getDailyStory();
            if (story) {
                showStoryReading(story.id);
            } else {
                alert("âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù‚ØµØ© Ù…ØªØ§Ø­Ø© Ø§Ù„ÙŠÙˆÙ…");
            }
        }

        function resetDailyStory(event) {
            event.stopPropagation();
            localStorage.removeItem('daily_story');
            displayDailyStory();
            alert('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù‚ØµØ© Ø§Ù„ÙŠÙˆÙ… - Ø¬Ø±Ø¨ÙŠ ØªØ¶ØºØ·ÙŠÙ† Ø¹Ù„Ù‰ Ù‚ØµØ© Ø§Ù„ÙŠÙˆÙ… Ù…Ø±Ø© Ø«Ø§Ù†ÙŠØ©!');
        }

        // ========== Firebase Auth (Ø§Ø³Ù… + Ø¨Ø§Ø³ÙˆØ±Ø¯ + ØªØ°ÙƒØ±Ù†ÙŠ) ==========
        function showLoginModal() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function hideLoginModal() {
            document.getElementById('loginModal').classList.add('hidden');
        }
async function handleLogin(event) {
    event.preventDefault();
    const name = document.getElementById('loginName').value.trim();
    const password = document.getElementById('loginPassword').value;
    const rememberMe = document.getElementById('rememberMe').checked;

    if (!name || !password) {
        alert("âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±");
        return;
    }

    // ğŸ‘ˆ ØªØ¹Ø¯ÙŠÙ„ Ù…Ù‡Ù…: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯ÙˆÙ…ÙŠÙ† ÙŠÙ‚Ø¨Ù„Ù‡ Firebase
    const email = (name.replace(/\s+/g, '').toLowerCase() || "user") + "@my-stories-site.firebaseapp.com";


    try {
await firebase.auth().setPersistence(
    rememberMe
        ? firebase.auth.Auth.Persistence.LOCAL
        : firebase.auth.Auth.Persistence.SESSION
);



        try {
            // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
            const cred = await auth.signInWithEmailAndPassword(email, password);
            if (!cred.user.displayName) {
                await cred.user.updateProfile({ displayName: name });
            }
        } catch (err) {
            if (err.code === "auth/user-not-found") {
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ø¬Ø¯ÙŠØ¯
                const cred = await auth.createUserWithEmailAndPassword(email, password);
                await cred.user.updateProfile({ displayName: name });
                await db.collection("users").doc(cred.user.uid).set({
                    name,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
            } else if (err.code === "auth/wrong-password") {
                alert("âŒ ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± ØºÙŠØ± ØµØ­ÙŠØ­Ø© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø§Ø³Ù….");
                return;
            } else {
                console.error(err);
                alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.");
                return;
            }
        }

        document.getElementById('loginName').value = '';
        document.getElementById('loginPassword').value = '';
        document.getElementById('rememberMe').checked = false;
        hideLoginModal();
    } catch (e) {
        console.error(e);
        alert("ØªØ¹Ø°Ø± Ø¥ÙƒÙ…Ø§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.");
    }
}


        // ========== Firestore â€“ Ø£ÙÙƒØ§Ø± ==========
        async function getIdeasFromDB() {
            const snapshot = await db.collection("ideas")
                .orderBy("createdAt", "desc")
                .get();

            return snapshot.docs.map(doc => {
                const data = doc.data();
                return {
                    id: doc.id,
                    text: data.text,
                    userName: data.userName || "Ù…Ø³ØªØ®Ø¯Ù…",
                    timestamp: data.createdAt
                        ? data.createdAt.toDate().toLocaleString('ar-SA')
                        : ''
                };
            });
        }

        async function saveIdeaToDB(text) {
            await db.collection("ideas").add({
                text,
                userName: getUserName(),
                userId: currentUser ? currentUser.uid : null,
                createdAt: serverTimestamp()
            });
        }

        async function displayIdeas() {
            const ideasList = document.getElementById('ideasList');
            try {
                const ideas = await getIdeasFromDB();
                if (!ideas.length) {
                    ideasList.innerHTML = '<p style="text-align: center; opacity: 0.6;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£ÙÙƒØ§Ø± Ø¨Ø¹Ø¯...</p>';
                    return;
                }
                ideasList.innerHTML = ideas.map(idea => `
                    <div class="discussion-item">
                        <div class="discussion-meta">
                            <span>â° ${idea.timestamp}</span>
                            <span class="user-badge">${idea.userName}</span>
                        </div>
                        <p>${idea.text}</p>
                    </div>
                `).join('');
            } catch (e) {
                console.error(e);
                ideasList.innerHTML = '<p style="text-align: center; opacity: 0.6;">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙÙƒØ§Ø±...</p>';
            }
        }

        async function submitIdea() {
            if (!currentUser) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                showLoginModal();
                return;
            }

            const ideaInput = document.getElementById('ideaInput');
            const idea = ideaInput.value.trim();
            if (!idea) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© ÙÙƒØ±Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            try {
                await saveIdeaToDB(idea);
                ideaInput.value = '';
                await displayIdeas();
                alert('âœ¨ Ø´ÙƒØ±Ø§Ù‹ Ù„Ùƒ! ØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙÙƒØ±ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­');
            } catch (e) {
                console.error(e);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„ÙÙƒØ±Ø©.');
            }
        }

        // ========== Firestore â€“ Ø§Ù„Ù†Ù‚Ø§Ø´Ø§Øª ==========
        async function getDiscussionsFromDB() {
            const snapshot = await db.collection("discussions")
                .orderBy("createdAt", "desc")
                .get();

            return snapshot.docs.map(doc => {
                const data = doc.data();
                const timestamp = data.createdAt
                    ? data.createdAt.toDate().toLocaleString('ar-SA')
                    : '';
                return {
                    id: doc.id,
                    text: data.text,
                    userName: data.userName || "Ù…Ø³ØªØ®Ø¯Ù…",
                    userId: data.userId || null,
                    likes: Array.isArray(data.likes) ? data.likes : [],
                    replies: Array.isArray(data.replies) ? data.replies : [],
                    timestamp
                };
            });
        }

        async function saveDiscussionToDB(text) {
            await db.collection("discussions").add({
                text,
                userName: getUserName(),
                userId: currentUser ? currentUser.uid : null,
                likes: [],
                replies: [],
                createdAt: serverTimestamp()
            });
        }

        async function displayDiscussions() {
            const discussionsList = document.getElementById('discussionsList');
            try {
                const discussions = await getDiscussionsFromDB();
                if (!discussions.length) {
                    discussionsList.innerHTML = '<p style="text-align: center; opacity: 0.6;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ù‚Ø§Ø´Ø§Øª Ø¨Ø¹Ø¯...</p>';
                    return;
                }

                discussionsList.innerHTML = discussions.map(discussion => {
                    const isLiked = currentUser && discussion.likes.includes(currentUser.uid);
                    return `
                    <div class="discussion-item">
                        <div class="discussion-meta">
                            <span>â° ${discussion.timestamp}</span>
                            <span class="user-badge">${discussion.userName}</span>
                        </div>
                        <p>${discussion.text}</p>

                        <div class="discussion-actions">
                            <button class="like-btn ${isLiked ? 'liked' : ''}" onclick="handleLike('${discussion.id}')">
                                â¤ï¸ ${discussion.likes.length}
                            </button>
                            <button class="reply-btn" onclick="toggleReplyForm('${discussion.id}')">
                                ğŸ’¬ Ø±Ø¯
                            </button>
                        </div>

                        <div class="reply-form" id="replyForm-${discussion.id}">
                            <textarea class="reply-input" id="replyInput-${discussion.id}" placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ..."></textarea>
                            <button class="submit-idea-btn" onclick="submitReply('${discussion.id}')" style="padding: 0.5rem 1rem; font-size: 0.9rem;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯</button>
                        </div>

                        ${discussion.replies.length ? `
                        <div class="replies-section">
                            ${discussion.replies.map(reply => `
                                <div class="reply-item">
                                    <div class="discussion-meta">
                                        <span>â° ${reply.timestamp || ''}</span>
                                        <span class="user-badge">${reply.userName || 'Ù…Ø³ØªØ®Ø¯Ù…'}</span>
                                    </div>
                                    <p>${reply.text}</p>
                                </div>
                            `).join('')}
                        </div>` : ''}
                    </div>
                    `;
                }).join('');
            } catch (e) {
                console.error(e);
                discussionsList.innerHTML = '<p style="text-align: center; opacity: 0.6;">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†Ù‚Ø§Ø´Ø§Øª...</p>';
            }
        }

        async function submitDiscussion() {
            if (!currentUser) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                showLoginModal();
                return;
            }

            const discussionInput = document.getElementById('discussionInput');
            const text = discussionInput.value.trim();
            if (!text) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ù†Ù‚Ø§Ø´ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            try {
                await saveDiscussionToDB(text);
                discussionInput.value = '';
                await displayDiscussions();
                alert('ğŸ’¬ ØªÙ… Ù†Ø´Ø± Ù†Ù‚Ø§Ø´Ùƒ Ø¨Ù†Ø¬Ø§Ø­');
            } catch (e) {
                console.error(e);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù†Ø´Ø± Ø§Ù„Ù†Ù‚Ø§Ø´.');
            }
        }

        function toggleReplyForm(discussionId) {
            if (!currentUser) {
                showLoginModal();
                return;
            }
            const replyForm = document.getElementById(`replyForm-${discussionId}`);
            replyForm.style.display = replyForm.style.display === 'block' ? 'none' : 'block';
        }

        async function submitReply(discussionId) {
            if (!currentUser) {
                showLoginModal();
                return;
            }
            const replyInput = document.getElementById(`replyInput-${discussionId}`);
            const replyText = replyInput.value.trim();
            if (!replyText) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ÙƒØªØ§Ø¨Ø© Ø±Ø¯ Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }

            try {
                const docRef = db.collection("discussions").doc(discussionId);
                const docSnap = await docRef.get();
                if (!docSnap.exists) return;

                const data = docSnap.data();
                const replies = Array.isArray(data.replies) ? data.replies : [];
                replies.unshift({
                    text: replyText,
                    userName: getUserName(),
                    userId: currentUser.uid,
                    timestamp: new Date().toLocaleString('ar-SA')
                });

                await docRef.update({ replies });
                replyInput.value = '';
                document.getElementById(`replyForm-${discussionId}`).style.display = 'none';
                await displayDiscussions();
            } catch (e) {
                console.error(e);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯.');
            }
        }

        async function handleLike(discussionId) {
            if (!currentUser) {
                showLoginModal();
                return;
            }

            try {
                const docRef = db.collection("discussions").doc(discussionId);
                const docSnap = await docRef.get();
                if (!docSnap.exists) return;

                const data = docSnap.data();
                const likes = Array.isArray(data.likes) ? data.likes : [];
                const index = likes.indexOf(currentUser.uid);

                if (index > -1) {
                    likes.splice(index, 1);
                } else {
                    likes.push(currentUser.uid);
                }

                await docRef.update({ likes });
                await displayDiscussions();
            } catch (e) {
                console.error(e);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨.');
            }
        }

        // ========== Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙˆØ§Ù„Ø£Ø³Ø¦Ù„Ø© + Firestore Ù„Ù„Ø£Ø¬ÙˆØ¨Ø© ==========
        function showStoryReading(storyId) {
            hideAllPages();
            document.getElementById('storyReadingSection').classList.remove('hidden');

            const story = stories.find(s => s.id === storyId);
            currentStoryId = storyId;

            setTheme(story.theme, story.title);

            document.getElementById('storyContent').innerHTML = `
                <h2 style="color: var(--primary-color); text-align: center; margin-bottom: 2rem;">${story.title}</h2>
                <div style="background: var(--secondary-color); padding: 2rem; border-radius: 15px; line-height: 1.8;">
                    ${story.content}
                </div>
            `;
        }

        function showQuestions() {
            hideAllPages();
            document.getElementById('questionsSection').classList.remove('hidden');

            const story = stories.find(s => s.id === currentStoryId);
            const questionsContainer = document.getElementById('questionsContainer');

            questionsContainer.innerHTML = story.questions.map((question, index) => `
                <div style="margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid var(--secondary-color);">
                    <h3 style="color: var(--text-color); margin-bottom: 1rem;">${question}</h3>
                    <textarea class="idea-input" id="answer${index}" placeholder="Ø§ÙƒØªØ¨ Ø¥Ø¬Ø§Ø¨ØªÙƒ Ù‡Ù†Ø§..."></textarea>
                </div>
            `).join('');

            questionsContainer.innerHTML += `
                <button class="submit-idea-btn" onclick="submitAnswers()">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø§Øª</button>
            `;

            displayStoryAnswers();
        }

        async function displayStoryAnswers() {
            const answersContainer = document.getElementById('answersContainer');
            if (!currentStoryId) {
                answersContainer.innerHTML = '';
                return;
            }

            try {
                const snapshot = await db.collection("storyAnswers")
                    .where("storyId", "==", currentStoryId)
                    .orderBy("createdAt", "desc")
                    .get();

                if (snapshot.empty) {
                    answersContainer.innerHTML = '<p style="text-align: center; opacity: 0.6;">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø¬ÙˆØ¨Ø© Ø¨Ø¹Ø¯...</p>';
                    return;
                }

                const answers = snapshot.docs.map(doc => {
                    const data = doc.data();
                    return {
                        text: data.text,
                        userName: data.userName || "Ù…Ø³ØªØ®Ø¯Ù…",
                        timestamp: data.createdAt
                            ? data.createdAt.toDate().toLocaleString('ar-SA')
                            : ''
                    };
                });

                answersContainer.innerHTML = answers.map(answer => `
                    <div class="discussion-item">
                        <div class="discussion-meta">
                            <span>â° ${answer.timestamp}</span>
                            <span class="user-badge">${answer.userName}</span>
                        </div>
                        <p>${answer.text}</p>
                    </div>
                `).join('');
            } catch (e) {
                console.error(e);
                answersContainer.innerHTML = '<p style="text-align: center; opacity: 0.6;">Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø¬ÙˆØ¨Ø©...</p>';
            }
        }

        async function submitAnswers() {
            if (!currentUser) {
                alert('âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
                showLoginModal();
                return;
            }

            const story = stories.find(s => s.id === currentStoryId);
            let hasNew = false;

            try {
                for (let i = 0; i < story.questions.length; i++) {
                    const answerInput = document.getElementById(`answer${i}`);
                    if (answerInput && answerInput.value.trim()) {
                        const text = answerInput.value.trim();
                        await db.collection("storyAnswers").add({
                            storyId: currentStoryId,
                            questionIndex: i,
                            text,
                            userName: getUserName(),
                            userId: currentUser.uid,
                            createdAt: serverTimestamp()
                        });
                        answerInput.value = '';
                        hasNew = true;
                    }
                }

                if (hasNew) {
                    await displayStoryAnswers();
                    alert('âœ… ØªÙ… Ø­ÙØ¸ Ø¥Ø¬Ø§Ø¨Ø§ØªÙƒ Ø¨Ù†Ø¬Ø§Ø­!');
                }
            } catch (e) {
                console.error(e);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø­ÙØ¸ Ø§Ù„Ø£Ø¬ÙˆØ¨Ø©.');
            }
        }

        // ========== Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª ==========
        function hideAllPages() {
            document.getElementById('homePage').classList.add('hidden');
            document.getElementById('storiesPage').classList.add('hidden');
            document.getElementById('cafePage').classList.add('hidden');
            document.getElementById('storyReadingSection').classList.add('hidden');
            document.getElementById('questionsSection').classList.add('hidden');
        }

        function showHomePage() {
            hideAllPages();
            document.getElementById('homePage').classList.remove('hidden');
            setTheme('', '');
            displayDailyStory();
            displayIdeas();
        }

        function showStoriesPage() {
            hideAllPages();
            document.getElementById('storiesPage').classList.remove('hidden');
            setTheme('', '');
            displayAllStories();
        }

        function showCafePage() {
            hideAllPages();
            document.getElementById('cafePage').classList.remove('hidden');
            setTheme('', '');
            displayDiscussions();
        }

        function displayAllStories() {
            const storiesGrid = document.getElementById('storiesGrid');
            storiesGrid.innerHTML = stories.map(story => `
                <div class="story-card" onclick="showStoryReading(${story.id})">
                    <span class="category">${story.category}</span>
                    <h3>${story.title}</h3>
                    <p>${story.description}</p>
                </div>
            `).join('');
        }

        // ========== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ==========
        function initialize() {
            showHomePage();
        }

        initialize();
    </script>
</body>
</html>



